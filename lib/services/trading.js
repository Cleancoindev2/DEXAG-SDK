"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_ethers=require("ethers"),_axios=_interopRequireDefault(require("axios")),_utility=_interopRequireDefault(require("./utility")),trading={getGas:function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(){var b,c,d,e,f;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b="https://ethgasstation.info/json/ethgasAPI.json",a.next=3,_axios["default"].get(b);case 3:return c=a.sent,d=c.data,e=d.safeLow/10,f=_ethers.ethers.utils.bigNumberify(1e9*e),a.abrupt("return",f);case 8:case"end":return a.stop();}},a)}));return function getGas(){return a.apply(this,arguments)}}(),setAllowance:function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(b,c,d,e){var f,g,h,i,j;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return f="115792089237316195423570985008687907853269984665640564039457584007913129639935",a.next=3,trading.getGas();case 3:return g=a.sent,h={gasPrice:g},a.next=7,b.approve(c,f,h);case 7:return i=a.sent,e("send_approve",i.hash),a.next=11,d.waitForTransaction(i.hash);case 11:return j=a.sent,e("mined_approve",i.hash),a.abrupt("return",!0);case 14:case"end":return a.stop();}},a)}));return function setAllowance(){return a.apply(this,arguments)}}(),wrap:function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(b,c,d,e){var f,g,h,i,j;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(0!=c){a.next=2;break}return a.abrupt("return",!0);case 2:return f=_ethers.ethers.utils.bigNumberify(c.toString()),a.next=5,trading.getGas();case 5:return g=a.sent,h={value:f,gasPrice:g},a.next=9,b.deposit(h);case 9:return i=a.sent,e("send_wrap",i.hash),a.next=13,d.waitForTransaction(i.hash);case 13:return j=a.sent,e("mined_wrap",i.hash),a.abrupt("return",!0);case 16:case"end":return a.stop();}},a)}));return function wrap(){return a.apply(this,arguments)}}(),unwrap:function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(b,c){var d,e,f,g,h;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(0!=c){a.next=2;break}return a.abrupt("return",!0);case 2:return a.next=4,trading.getGas();case 4:return d=a.sent,e={gasPrice:d},f=_ethers.ethers.utils.bigNumberify(c.toString()),a.next=9,b.withdraw(f,e);case 9:return g=a.sent,handler("send_unwrap",g.hash),a.next=13,provider.waitForTransaction(g.hash);case 13:return h=a.sent,handler("mined_unwrap",g.hash),a.abrupt("return",!0);case 16:case"end":return a.stop();}},a)}));return function unwrap(){return a.apply(this,arguments)}}(),getTrade:function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(b){var c,d,e;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=_axios["default"].create({baseURL:"https://api.dex.ag/"}),a.next=3,c.get("/trade",{params:b});case 3:return d=a.sent,e=d.data,a.abrupt("return",e);case 6:case"end":return a.stop();}},a)}));return function getTrade(){return a.apply(this,arguments)}}(),getPrice:function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(b){var c,d,e;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=_axios["default"].create({baseURL:"https://api.dex.ag/"}),a.next=3,c.get("/trade",{params:b});case 3:return d=a.sent,e=d.data,a.abrupt("return",e);case 6:case"end":return a.stop();}},a)}));return function getPrice(){return a.apply(this,arguments)}}()},_default=trading;exports["default"]=_default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zZXJ2aWNlcy90cmFkaW5nLmpzIl0sIm5hbWVzIjpbInRyYWRpbmciLCJnZXRHYXMiLCJ1cmwiLCJheGlvcyIsImdldCIsInJlc3BvbnNlIiwiZGF0YSIsImdhc0d3ZWkiLCJzYWZlTG93IiwiZ2FzV2VpIiwiZXRoZXJzIiwidXRpbHMiLCJiaWdOdW1iZXJpZnkiLCJzZXRBbGxvd2FuY2UiLCJ0b2tlbkNvbnRyYWN0IiwiZXhjaGFuZ2VBZGRyZXNzIiwicHJvdmlkZXIiLCJoYW5kbGVyIiwidWludE1heCIsImdhc1ByaWNlIiwidHhPcHRpb25zIiwiYXBwcm92ZSIsInN0YXR1cyIsImhhc2giLCJ3YWl0Rm9yVHJhbnNhY3Rpb24iLCJyZWNlaXB0Iiwid3JhcCIsIndldGhDb250cmFjdCIsImFtb3VudCIsInZhbHVlIiwidG9TdHJpbmciLCJkZXBvc2l0IiwidW53cmFwIiwiYW1vdW50TnVtYmVyIiwid2l0aGRyYXciLCJnZXRUcmFkZSIsInBhcmFtcyIsImRleGFnQ2xpZW50IiwiY3JlYXRlIiwiYmFzZVVSTCIsInRyYWRlIiwiZ2V0UHJpY2UiLCJwcmljZSJdLCJtYXBwaW5ncyI6IjhkQUtNQSxPQUFPLENBQUcsQ0FDZEMsTUFBTSw4RkFBRSxxSEFDQUMsQ0FBQUEsQ0FEQSxDQUNNLGdEQUROLFVBRWlCQyxrQkFBTUMsR0FBTixDQUFVRixDQUFWLENBRmpCLGNBRUFHLENBQUFBLENBRkEsUUFHQUMsQ0FIQSxDQUdPRCxDQUFRLENBQUNDLElBSGhCLENBSUFDLENBSkEsQ0FJVUQsQ0FBSSxDQUFDRSxPQUFMLENBQWUsRUFKekIsQ0FLQUMsQ0FMQSxDQUtTQyxlQUFPQyxLQUFQLENBQWFDLFlBQWIsQ0FBb0MsR0FBVixDQUFBTCxDQUExQixDQUxULG1CQU1DRSxDQU5ELHlDQUFGLDhEQURRLENBU2RJLFlBQVksOEZBQUUsV0FBTUMsQ0FBTixDQUFxQkMsQ0FBckIsQ0FBc0NDLENBQXRDLENBQWdEQyxDQUFoRCwwR0FDTkMsQ0FBQUEsQ0FE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QUFNLENBQU5BLENBQUYsQ0FBMUIsQ0FKZixjQUlGL0IsQ0FBQUEsQ0FKRSxRQUtGcUMsQ0FMRSxDQUtNckMsQ0FBUSxDQUFDQyxJQUxmLG1CQU1Eb0MsQ0FOQyx5Q0FBRixnRUFqRU0sQyxVQTJFRDFDLE8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBldGhlcnMgfSBmcm9tICdldGhlcnMnO1xuaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJztcblxuaW1wb3J0IHV0aWxpdHkgZnJvbSAnLi91dGlsaXR5JztcblxuY29uc3QgdHJhZGluZyA9IHtcbiAgZ2V0R2FzOiBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgdXJsID0gJ2h0dHBzOi8vZXRoZ2Fzc3RhdGlvbi5pbmZvL2pzb24vZXRoZ2FzQVBJLmpzb24nO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KHVybCk7XG4gICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgY29uc3QgZ2FzR3dlaSA9IGRhdGEuc2FmZUxvdyAvIDEwO1xuICAgIGNvbnN0IGdhc1dlaSA9IGV0aGVycy51dGlscy5iaWdOdW1iZXJpZnkoZ2FzR3dlaSAqIDFlOSk7XG4gICAgcmV0dXJuIGdhc1dlaTtcbiAgfSxcbiAgc2V0QWxsb3dhbmNlOiBhc3luYyh0b2tlbkNvbnRyYWN0LCBleGNoYW5nZUFkZHJlc3MsIHByb3ZpZGVyLCBoYW5kbGVyKSA9PiB7XG4gICAgY29uc3QgdWludE1heCA9ICcxMTU3OTIwODkyMzczMTYxOTU0MjM1NzA5ODUwMDg2ODc5MDc4NTMyNjk5ODQ2NjU2NDA1NjQwMzk0NTc1ODQwMDc5MTMxMjk2Mzk5MzUnO1xuICAgIGNvbnN0IGdhc1ByaWNlID0gYXdhaXQgdHJhZGluZy5nZXRHYXMoKTtcbiAgICBjb25zdCB0eE9wdGlvbnMgPSB7XG4gICAgICBnYXNQcmljZSxcbiAgICB9O1xuICAgIGNvbnN0IHN0YXR1cyA9IGF3YWl0IHRva2VuQ29udHJhY3QuYXBwcm92ZShleGNoYW5nZUFkZHJlc3MsIHVpbnRNYXgsIHR4T3B0aW9ucyk7XG4gICAgaGFuZGxlcignc2VuZF9hcHByb3ZlJywgc3RhdHVzLmhhc2gpO1xuICAgIC8vIHdhaXQgZm9yIG1pbmluZyB0byBmaW5pc2hcbiAgICBjb25zdCByZWNlaXB0ID0gYXdhaXQgcHJvdmlkZXIud2FpdEZvclRyYW5zYWN0aW9uKHN0YXR1cy5oYXNoKTtcbiAgICAvLyBtaW5lZFxuICAgIGhhbmRsZXIoJ21pbmVkX2FwcHJvdmUnLCBzdGF0dXMuaGFzaCk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0sXG4gIHdyYXA6IGFzeW5jKHdldGhDb250cmFjdCwgYW1vdW50LCBwcm92aWRlciwgaGFuZGxlcikgPT4ge1xuICAgIGlmIChhbW91bnQgPT0gMCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGNvbnN0IHZhbHVlID0gZXRoZXJzLnV0aWxzLmJpZ051bWJlcmlmeShhbW91bnQudG9TdHJpbmcoKSk7XG4gICAgY29uc3QgZ2FzUHJpY2UgPSBhd2FpdCB0cmFkaW5nLmdldEdhcygpO1xuICAgIGNvbnN0IHR4T3B0aW9ucyA9IHtcbiAgICAgIHZhbHVlLFxuICAgICAgZ2FzUHJpY2UsXG4gICAgfTtcbiAgICBjb25zdCBzdGF0dXMgPSBhd2FpdCB3ZXRoQ29udHJhY3QuZGVwb3NpdCh0eE9wdGlvbnMpO1xuXG4gICAgaGFuZGxlcignc2VuZF93cmFwJywgc3RhdHVzLmhhc2gpO1xuICAgIGNvbnN0IHJlY2VpcHQgPSBhd2FpdCBwcm92aWRlci53YWl0Rm9yVHJhbnNhY3Rpb24oc3RhdHVzLmhhc2gpO1xuICAgIC8vIHdyYXAgbWluZWRcbiAgICBoYW5kbGVyKCdtaW5lZF93cmFwJywgc3RhdHVzLmhhc2gpO1xuICAgIHJldHVybiB0cnVlO1xuICB9LFxuICB1bndyYXA6IGFzeW5jKHdldGhDb250cmFjdCwgYW1vdW50KSA9PiB7XG4gICAgaWYgKGFtb3VudCA9PSAwKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgY29uc3QgZ2FzUHJpY2UgPSBhd2FpdCB0cmFkaW5nLmdldEdhcygpO1xuICAgIGNvbnN0IHR4T3B0aW9ucyA9IHtcbiAgICAgIGdhc1ByaWNlLFxuICAgIH07XG4gICAgY29uc3QgYW1vdW50TnVtYmVyID0gZXRoZXJzLnV0aWxzLmJpZ051bWJlcmlmeShhbW91bnQudG9TdHJpbmcoKSk7XG4gICAgY29uc3Qgc3RhdHVzID0gYXdhaXQgd2V0aENvbnRyYWN0LndpdGhkcmF3KGFtb3VudE51bWJlciwgdHhPcHRpb25zKTtcbiAgICBoYW5kbGVyKCdzZW5kX3Vud3JhcCcsIHN0YXR1cy5oYXNoKTtcbiAgICBjb25zdCByZWNlaXB0ID0gYXdhaXQgcHJvdmlkZXIud2FpdEZvclRyYW5zYWN0aW9uKHN0YXR1cy5oYXNoKTtcbiAgICAvLyB3cmFwIG1pbmVkXG4gICAgaGFuZGxlcignbWluZWRfdW53cmFwJywgc3RhdHVzLmhhc2gpO1xuICAgIHJldHVybiB0cnVlO1xuICB9LFxuICBnZXRUcmFkZTogYXN5bmMgKHBhcmFtcykgPT4ge1xuICAgIGNvbnN0IGRleGFnQ2xpZW50ID0gYXhpb3MuY3JlYXRlKHtcbiAgICAgIGJhc2VVUkw6ICdodHRwczovL2FwaS5kZXguYWcvJyxcbiAgICB9KTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGRleGFnQ2xpZW50LmdldCgnL3RyYWRlJywgeyBwYXJhbXMgfSk7XG4gICAgY29uc3QgdHJhZGUgPSByZXNwb25zZS5kYXRhO1xuICAgIHJldHVybiB0cmFkZTtcbiAgfSxcbiAgZ2V0UHJpY2U6IGFzeW5jIChwYXJhbXMpID0+IHtcbiAgICBjb25zdCBkZXhhZ0NsaWVudCA9IGF4aW9zLmNyZWF0ZSh7XG4gICAgICBiYXNlVVJMOiAnaHR0cHM6Ly9hcGkuZGV4LmFnLycsXG4gICAgfSk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBkZXhhZ0NsaWVudC5nZXQoJy90cmFkZScsIHsgcGFyYW1zIH0pO1xuICAgIGNvbnN0IHByaWNlID0gcmVzcG9uc2UuZGF0YTtcbiAgICByZXR1cm4gcHJpY2U7XG4gIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCB0cmFkaW5nO1xuIl19