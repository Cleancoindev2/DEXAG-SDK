"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_ethers=require("ethers"),_axios=_interopRequireDefault(require("axios")),_erc=_interopRequireDefault(require("../../abi/erc20.json")),_weth=_interopRequireDefault(require("../../abi/weth.json")),utility={getTokenContract:function getTokenContract(a,b){var c=a.metadata.input.address;return new _ethers.ethers.Contract(c,_erc["default"],b)},getWethContract:function getWethContract(a){return new _ethers.ethers.Contract("0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2",_weth["default"],a)},getEtherToWrap:function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(b,c,d){var e,f,g,h,i,j,k,l;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(e="0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2",b.metadata.input){a.next=3;break}return a.abrupt("return",0);case 3:if(b.metadata.input.address==e){a.next=5;break}return a.abrupt("return",0);case 5:return f=b.metadata.input.amount,g=new _ethers.ethers.Contract(e,_erc["default"],d),a.next=9,d.getAddress();case 9:return h=a.sent,a.next=12,g.balanceOf(h);case 12:return i=a.sent,a.next=15,d.getBalance();case 15:if(j=a.sent,!i.gte(f)){a.next=18;break}return a.abrupt("return",0);case 18:if(k=j.add(i),!k.lt(f)){a.next=21;break}return a.abrupt("return",-1);case 21:return l=i.sub(f).mul(-1),a.abrupt("return",l.toString());case 23:case"end":return a.stop();}},a)}));return function getEtherToWrap(){return a.apply(this,arguments)}}(),handleReceipt:function handleReceipt(a,b,c){"0x1"==b.status?c("mined_trade",a.hash):c("failed",a.hash)},track:function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(b,c,d){var e,f;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e={status:b,details:c,trade:d},f=_axios["default"].create({baseURL:"https://api.dex.ag/"}),a.next=4,f.post("/send_trade",e);case 4:case"end":return a.stop();}},a)}));return function track(){return a.apply(this,arguments)}}()},_default=utility;exports["default"]=_default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zZXJ2aWNlcy91dGlsaXR5LmpzIl0sIm5hbWVzIjpbInV0aWxpdHkiLCJnZXRUb2tlbkNvbnRyYWN0IiwidHJhZGUiLCJzaWduZXIiLCJ0b2tlbkFkZHJlc3MiLCJtZXRhZGF0YSIsImlucHV0IiwiYWRkcmVzcyIsImV0aGVycyIsIkNvbnRyYWN0IiwiZXJjMjBBYmkiLCJnZXRXZXRoQ29udHJhY3QiLCJ3ZXRoQWJpIiwiZ2V0RXRoZXJUb1dyYXAiLCJwcm92aWRlciIsIndldGhUb2tlbkFkZHJlc3MiLCJ3ZXRoQW1vdW50IiwiYW1vdW50Iiwid2V0aENvbnRyYWN0IiwiZ2V0QWRkcmVzcyIsImFjY291bnRBZGRyZXNzIiwiYmFsYW5jZU9mIiwid2V0aEJhbGFuY2UiLCJnZXRCYWxhbmNlIiwiYmFsYW5jZSIsImd0ZSIsInRvdGFsQmFsYW5jZSIsImFkZCIsImx0IiwiZXRoVG9XcmFwIiwic3ViIiwibXVsIiwidG9TdHJpbmciLCJoYW5kbGVSZWNlaXB0Iiwic3RhdHVzIiwicmVjZWlwdCIsImhhbmRsZXIiLCJoYXNoIiwidHJhY2siLCJkZXRhaWxzIiwiZGF0YSIsImRleGFnQ2xpZW50IiwiYXhpb3MiLCJjcmVhdGUiLCJiYXNlVVJMIiwicG9zdCJdLCJtYXBwaW5ncyI6ImtpQkFNTUEsT0FBTyxDQUFHLENBQ2RDLGdCQUFnQixDQUFFLDBCQUFDQyxDQUFELENBQVFDLENBQVIsQ0FBbUIsQ0FDbkMsR0FBTUMsQ0FBQUEsQ0FBWSxDQUFHRixDQUFLLENBQUNHLFFBQU4sQ0FBZUMsS0FBZixDQUFxQkMsT0FBMUMsQ0FDQSxNQUFPLElBQUlDLGdCQUFPQyxRQUFYLENBQW9CTCxDQUFwQixDQUFrQ00sZUFBbEMsQ0FBNENQLENBQTVDLENBQ1IsQ0FKYSxDQUtkUSxlQUFlLENBQUUseUJBQUNSLENBQUQsQ0FBWSxDQUUzQixNQUFPLElBQUlLLGdCQUFPQyxRQUFYLDhDQUFzQ0csZ0JBQXRDLENBQStDVCxDQUEvQyxDQUNSLENBUmEsQ0FTUlUsY0FUUSx5R0FTT1gsQ0FUUCxDQVNjWSxDQVRkLENBU3dCWCxDQVR4Qiw2R0FVTlksQ0FWTSxDQVVhLDRDQVZiLENBV1BiLENBQUssQ0FBQ0csUUFBTixDQUFlQyxLQVhSLDBDQVlILENBWkcsWUFjUkosQ0FBSyxDQUFDRyxRQUFOLENBQWVDLEtBQWYsQ0FBcUJDLE9BQXJCLEVBQWdDUSxDQWR4QiwwQ0FlSCxDQWZHLGVBaUJOQyxDQUFBQSxDQWpCTSxDQWlCT2QsQ0FBSyxDQUFDRyxRQUFOLENBQWVDLEtBQWYsQ0FBcUJXLE1BakI1QixDQWtCTkMsQ0FsQk0sQ0FrQlMsR0FBSVYsZ0JBQU9DLFFBQVgsQ0FBb0JNLENBQXBCLENBQXNDTCxlQUF0QyxDQUFnRFAsQ0FBaEQsQ0FsQlQsVUFtQmlCQSxDQUFNLENBQUNnQixVQUFQLEVBbkJqQixjQW1CTkMsQ0FBQUEsQ0FuQk0sa0JBb0JjRixDQUFZLENBQUNHLFNBQWIsQ0FBdUJELENBQXZCLENBcEJkLGVBb0JORSxDQUFBQSxDQXBCTSxrQkFxQlVuQixDQUFNLENBQUNvQixVQUFQLEVBckJWLFlBcUJOQyxDQXJCTSxTQXNCUkYsQ0FBVyxDQUFDRyxHQUFaLENBQWdCVCxDQUFoQixDQXRCUSwyQ0F3QkgsQ0F4QkcsYUEwQk5VLENBMUJNLENBMEJTRixDQUFPLENBQUNHLEdBQVIsQ0FBWUwsQ0FBWixDQTFCVCxFQTJCUkksQ0FBWSxDQUFDRSxFQUFiLENBQWdCWixDQUFoQixDQTNCUSwyQ0E2QkgsQ0FBQyxDQTdCRSxnQkFnQ05hLENBQUFBLENBaENNLENBZ0NNUCxDQUFXLENBQUNRLEdBQVosQ0FBZ0JkLENBQWhCLEVBQTRCZSxHQUE1QixDQUFnQyxDQUFDLENBQWpDLENBaENOLG1CQWlDTEYsQ0FBUyxDQUFDRyxRQUFWLEVBakNLLGlIQW1DZEMsYUFBYSxDQUFFLHVCQUFDQyxDQUFELENBQVNDLENBQVQsQ0FBa0JDLENBQWxCLENBQTZCLENBQ3ZCLEtBQWhCLEVBQUFELENBQU8sQ0FBQ0QsTUFEK0IsQ0FFeENFLENBQU8sQ0FBQyxhQUFELENBQWdCRixDQUFNLENBQUNHLElBQXZCLENBRmlDLENBSXhDRCxDQUFPLENBQUMsUUFBRCxDQUFXRixDQUFNLENBQUNHLElBQWxCLENBRVYsQ0F6Q2EsQ0EwQ2RDLEtBQUssOEZBQUUsV0FBTUosQ0FBTixDQUFjSyxDQUFkLENBQXVCckMsQ0FBdkIsb0dBQ0NzQyxDQUFBQSxDQURELENBQ1EsQ0FDWE4sTUFBTSxDQUFOQSxDQURXLENBRVhLLE9BQU8sQ0FBUEEsQ0FGVyxDQUdYckMsS0FBSyxDQUFMQSxDQUhXLENBRFIsQ0FNQ3VDLENBTkQsQ0FNZUMsa0JBQU1DLE1BQU4sQ0FBYSxDQUMvQkMsT0FBTyxDQUFFLHFCQURzQixDQUFiLENBTmYsVUFTQ0gsQ0FBVyxDQUFDSSxJQUFaLENBQWlCLGFBQWpCLENBQWdDTCxDQUFoQyxDQVRELHdDQUFGLDZEQTFDUyxDLFVBdUREeEMsTyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV0aGVycyB9IGZyb20gJ2V0aGVycyc7XG5pbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnO1xuXG5pbXBvcnQgZXJjMjBBYmkgZnJvbSAnLi4vLi4vYWJpL2VyYzIwLmpzb24nO1xuaW1wb3J0IHdldGhBYmkgZnJvbSAnLi4vLi4vYWJpL3dldGguanNvbic7XG5cbmNvbnN0IHV0aWxpdHkgPSB7XG4gIGdldFRva2VuQ29udHJhY3Q6ICh0cmFkZSwgc2lnbmVyKSA9PiB7XG4gICAgY29uc3QgdG9rZW5BZGRyZXNzID0gdHJhZGUubWV0YWRhdGEuaW5wdXQuYWRkcmVzcztcbiAgICByZXR1cm4gbmV3IGV0aGVycy5Db250cmFjdCh0b2tlbkFkZHJlc3MsIGVyYzIwQWJpLCBzaWduZXIpO1xuICB9LFxuICBnZXRXZXRoQ29udHJhY3Q6IChzaWduZXIpID0+IHtcbiAgICBjb25zdCB3ZXRoVG9rZW5BZGRyZXNzID0gJzB4YzAyYWFhMzliMjIzZmU4ZDBhMGU1YzRmMjdlYWQ5MDgzYzc1NmNjMic7XG4gICAgcmV0dXJuIG5ldyBldGhlcnMuQ29udHJhY3Qod2V0aFRva2VuQWRkcmVzcywgd2V0aEFiaSwgc2lnbmVyKTtcbiAgfSxcbiAgYXN5bmMgZ2V0RXRoZXJUb1dyYXAodHJhZGUsIHByb3ZpZGVyLCBzaWduZXIpIHtcbiAgICBjb25zdCB3ZXRoVG9rZW5BZGRyZXNzID0gJzB4YzAyYWFhMzliMjIzZmU4ZDBhMGU1YzRmMjdlYWQ5MDgzYzc1NmNjMic7XG4gICAgaWYgKCF0cmFkZS5tZXRhZGF0YS5pbnB1dCkge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGlmICh0cmFkZS5tZXRhZGF0YS5pbnB1dC5hZGRyZXNzICE9IHdldGhUb2tlbkFkZHJlc3MpIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBjb25zdCB3ZXRoQW1vdW50ID0gdHJhZGUubWV0YWRhdGEuaW5wdXQuYW1vdW50O1xuICAgIGNvbnN0IHdldGhDb250cmFjdCA9IG5ldyBldGhlcnMuQ29udHJhY3Qod2V0aFRva2VuQWRkcmVzcywgZXJjMjBBYmksIHNpZ25lcik7XG4gICAgY29uc3QgYWNjb3VudEFkZHJlc3MgPSBhd2FpdCBzaWduZXIuZ2V0QWRkcmVzcygpO1xuICAgIGNvbnN0IHdldGhCYWxhbmNlID0gYXdhaXQgd2V0aENvbnRyYWN0LmJhbGFuY2VPZihhY2NvdW50QWRkcmVzcyk7XG4gICAgY29uc3QgYmFsYW5jZSA9IGF3YWl0IHNpZ25lci5nZXRCYWxhbmNlKCk7XG4gICAgaWYgKHdldGhCYWxhbmNlLmd0ZSh3ZXRoQW1vdW50KSkge1xuICAgICAgLy8gRW5vdWdoIHdldGgsIG5vIG5lZWQgdG8gd3JhcFxuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGNvbnN0IHRvdGFsQmFsYW5jZSA9IGJhbGFuY2UuYWRkKHdldGhCYWxhbmNlKTtcbiAgICBpZiAodG90YWxCYWxhbmNlLmx0KHdldGhBbW91bnQpKSB7XG4gICAgICAvLyBJbnN1ZmZpY2llbnQgYmFsYW5jZVxuICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICAvLyBldGggdG8gd3JhcCA9IHdldGggcmVxdWlyZWQgZm9yIHRyYWRlIC0gd2V0aCBiYWxhbmNlXG4gICAgY29uc3QgZXRoVG9XcmFwID0gd2V0aEJhbGFuY2Uuc3ViKHdldGhBbW91bnQpLm11bCgtMSk7XG4gICAgcmV0dXJuIGV0aFRvV3JhcC50b1N0cmluZygpO1xuICB9LFxuICBoYW5kbGVSZWNlaXB0OiAoc3RhdHVzLCByZWNlaXB0LCBoYW5kbGVyKT0+IHtcbiAgICBpZihyZWNlaXB0LnN0YXR1cz09JzB4MScpe1xuICAgICAgaGFuZGxlcignbWluZWRfdHJhZGUnLCBzdGF0dXMuaGFzaCk7XG4gICAgfWVsc2V7XG4gICAgICBoYW5kbGVyKCdmYWlsZWQnLCBzdGF0dXMuaGFzaCk7XG4gICAgfVxuICB9LFxuICB0cmFjazogYXN5bmMoc3RhdHVzLCBkZXRhaWxzLCB0cmFkZSk9PntcbiAgICBjb25zdCBkYXRhID0ge1xuICAgICAgc3RhdHVzLFxuICAgICAgZGV0YWlscyxcbiAgICAgIHRyYWRlLFxuICAgIH07XG4gICAgY29uc3QgZGV4YWdDbGllbnQgPSBheGlvcy5jcmVhdGUoe1xuICAgICAgYmFzZVVSTDogJ2h0dHBzOi8vYXBpLmRleC5hZy8nLFxuICAgIH0pO1xuICAgIGF3YWl0IGRleGFnQ2xpZW50LnBvc3QoJy9zZW5kX3RyYWRlJywgZGF0YSk7XG4gIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCB1dGlsaXR5O1xuIl19