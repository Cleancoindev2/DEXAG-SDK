"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_utility=_interopRequireDefault(require("./utility")),_trading=_interopRequireDefault(require("./trading")),_account=_interopRequireDefault(require("./account")),validate={web3:function(a){function b(){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(/*#__PURE__*/function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(b,c,d){var e,f,g,h,i,j,k,l,m,n;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(window.web3StatusHandler("init"),null!=window.web3&&0!=Object.keys(window.web3).length){a.next=4;break}return window.web3StatusHandler("web3_undefined"),a.abrupt("return",!1);case 4:if(null!=window.web3&&null!=window.web3.eth.accounts[0]){a.next=14;break}return a.prev=5,a.next=8,window.ethereum.enable();case 8:a.next=14;break;case 10:return a.prev=10,a.t0=a["catch"](5),window.web3StatusHandler("connect_rejected"),a.abrupt("return",!1);case 14:if(null!=window.web3.eth.accounts[0]){a.next=17;break}return window.web3StatusHandler("unlock_wallet"),a.abrupt("return");case 17:if("No trades"!=b.error){a.next=19;break}return a.abrupt("return",!1);case 19:if(1==web3.version.network){a.next=22;break}return window.web3StatusHandler("network"),a.abrupt("return",!1);case 22:return a.next=24,_utility["default"].getEtherToWrap(b,c,d);case 24:if(e=a.sent,-1!=e){a.next=28;break}return window.web3StatusHandler("balance"),a.abrupt("return",!1);case 28:return f=_utility["default"].getWethContract(d),a.next=31,_trading["default"].wrap(f,e,c);case 31:if(g=a.sent,g){a.next=34;break}return a.abrupt("return",!1);case 34:if(!b.metadata.input){a.next=40;break}return a.next=37,_account["default"].getERC20Balance(b,c,d);case 37:h=a.sent,a.next=49;break;case 40:return a.prev=40,a.next=43,_account["default"].getETHBalance(b);case 43:h=a.sent,a.next=49;break;case 46:a.prev=46,a.t1=a["catch"](40),console.log(a.t1);case 49:if(h){a.next=52;break}return window.web3StatusHandler("balance"),a.abrupt("return",!1);case 52:if(!b.metadata.input){a.next=69;break}return i=_utility["default"].getTokenContract(b,d),j=b.metadata.input.spender,a.next=57,c.getSigner().getAddress();case 57:return k=a.sent,a.next=60,i.allowance(k,j);case 60:if(l=a.sent,m=b.metadata.input.amount,!l.lt(m)){a.next=69;break}return window.web3StatusHandler("allowance"),a.next=66,_trading["default"].setAllowance(i,j);case 66:if(n=a.sent,n){a.next=69;break}return a.abrupt("return",!1);case 69:return a.abrupt("return",!0);case 70:case"end":return a.stop();}},a,null,[[5,10],[40,46]])}));return function(){return a.apply(this,arguments)}}())},_default=validate;exports["default"]=_default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zZXJ2aWNlcy92YWxpZGF0ZS5qcyJdLCJuYW1lcyI6WyJ2YWxpZGF0ZSIsIndlYjMiLCJ0cmFkZSIsInByb3ZpZGVyIiwic2lnbmVyIiwid2luZG93Iiwid2ViM1N0YXR1c0hhbmRsZXIiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwiZXRoIiwiYWNjb3VudHMiLCJldGhlcmV1bSIsImVuYWJsZSIsImVycm9yIiwidmVyc2lvbiIsIm5ldHdvcmsiLCJ1dGlsaXR5IiwiZ2V0RXRoZXJUb1dyYXAiLCJldGhlclRvV3JhcCIsIndldGhDb250cmFjdCIsImdldFdldGhDb250cmFjdCIsInRyYWRpbmciLCJ3cmFwIiwid3JhcHBpbmciLCJtZXRhZGF0YSIsImlucHV0IiwiYWNjb3VudCIsImdldEVSQzIwQmFsYW5jZSIsImJhbGFuY2UiLCJnZXRFVEhCYWxhbmNlIiwiY29uc29sZSIsImxvZyIsInRva2VuQ29udHJhY3QiLCJnZXRUb2tlbkNvbnRyYWN0IiwiZXhjaGFuZ2VBZGRyZXNzIiwic3BlbmRlciIsImdldFNpZ25lciIsImdldEFkZHJlc3MiLCJhZGRyZXNzIiwiYWxsb3dhbmNlIiwidG9rZW5BbW91bnQiLCJhbW91bnQiLCJsdCIsInNldEFsbG93YW5jZSIsInRyYWRpbmdfYWxsb3dhbmNlIl0sIm1hcHBpbmdzIjoiZ2dCQUlNQSxRQUFRLENBQUcsQ0FDZkMsSUFBSSx3TkFBRSxXQUFPQyxDQUFQLENBQWNDLENBQWQsQ0FBd0JDLENBQXhCLGlIQUVKQyxNQUFNLENBQUNDLGlCQUFQLENBQXlCLE1BQXpCLENBRkksQ0FLQSxNQUFBRCxNQUFNLENBQUNKLElBQVAsRUFBK0QsQ0FBbkMsRUFBQU0sTUFBTSxDQUFDQyxJQUFQLENBQVlILE1BQU0sQ0FBQ0osSUFBbkIsRUFBeUJRLE1BTHJELHVCQU1GSixDQUFBQSxNQUFNLENBQUNDLGlCQUFQLENBQXlCLGdCQUF6QixDQU5FLGlDQVdBLE1BQUFELE1BQU0sQ0FBQ0osSUFBUCxFQUE0QixNQUFBSSxNQUFNLENBQUNKLElBQVAsQ0FBWVMsR0FBWixDQUFnQkMsUUFBaEIsQ0FBeUIsQ0FBekIsQ0FYNUIsMkNBYU1OLE1BQU0sQ0FBQ08sUUFBUCxDQUFnQkMsTUFBaEIsRUFiTixvRUFnQkFSLE1BQU0sQ0FBQ0MsaUJBQVAsQ0FBeUIsa0JBQXpCLENBaEJBLGtDQXNCRCxNQUFBRCxNQUFNLENBQUNKLElBQVAsQ0FBWVMsR0FBWixDQUFnQkMsUUFBaEIsQ0FBeUIsQ0FBekIsQ0F0QkMsd0JBdUJGTixDQUFBQSxNQUFNLENBQUNDLGlCQUFQLENBQXlCLGVBQXpCLENBdkJFLCtCQTRCZSxXQUFmLEVBQUFKLENBQUssQ0FBQ1ksS0E1Qk4sMERBZ0N3QixDQUF4QixFQUFBYixJQUFJLENBQUNjLE9BQUwsQ0FBYUMsT0FoQ2Isd0JBaUNGWCxDQUFBQSxNQUFNLENBQUNDLGlCQUFQLENBQXlCLFNBQXpCLENBakNFLGdEQXNDc0JXLG9CQUFRQyxjQUFSLENBQXVCaEIsQ0FBdkIsQ0FBOEJDLENBQTlCLENBQXdDQyxDQUF4QyxDQXRDdEIsWUFzQ0VlLENBdENGLFFBdUNlLENBQUMsQ0FBaEIsRUFBQUEsQ0F2Q0Esd0JBd0NGZCxDQUFBQSxNQUFNLENBQUNDLGlCQUFQLENBQXlCLFNBQXpCLENBeENFLHFDQTRDRWMsQ0FBQUEsQ0E1Q0YsQ0E0Q2lCSCxvQkFBUUksZUFBUixDQUF3QmpCLENBQXhCLENBNUNqQixXQTZDbUJrQixvQkFBUUMsSUFBUixDQUFhSCxDQUFiLENBQTJCRCxDQUEzQixDQUF3Q2hCLENBQXhDLENBN0NuQixZQTZDRXFCLENBN0NGLFFBOENDQSxDQTlDRCwyREFrRER0QixDQUFLLENBQUN1QixRQUFOLENBQWVDLEtBbERkLG1DQW9EY0Msb0JBQVFDLGVBQVIsQ0FBd0IxQixDQUF4QixDQUErQkMsQ0FBL0IsQ0FBeUNDLENBQXpDLENBcERkLFNBb0RGeUIsQ0FwREUsMkRBd0RnQkYsb0JBQVFHLGFBQVIsQ0FBc0I1QixDQUF0QixDQXhEaEIsU0F3REEyQixDQXhEQSw4REEwREFFLE9BQU8sQ0FBQ0MsR0FBUixNQTFEQSxZQTZEQ0gsQ0E3REQsd0JBOERGeEIsQ0FBQUEsTUFBTSxDQUFDQyxpQkFBUCxDQUF5QixTQUF6QixDQTlERSxtQ0FrRUFKLENBQUssQ0FBQ3VCLFFBQU4sQ0FBZUMsS0FsRWYsd0JBb0VJTyxDQUFBQSxDQXBFSixDQW9Fb0JoQixvQkFBUWlCLGdCQUFSLENBQXlCaEMsQ0FBekIsQ0FBZ0NFLENBQWhDLENBcEVwQixDQXFFSStCLENBckVKLENBcUVzQmpDLENBQUssQ0FBQ3VCLFFBQU4sQ0FBZUMsS0FBZixDQUFxQlUsT0FyRTNDLFdBdUVvQmpDLENBQVEsQ0FBQ2tDLFNBQVQsR0FBcUJDLFVBQXJCLEVBdkVwQixlQXVFSUMsQ0FBQUEsQ0F2RUosa0JBeUVzQk4sQ0FBYSxDQUFDTyxTQUFkLENBQXdCRCxDQUF4QixDQUFpQ0osQ0FBakMsQ0F6RXRCLFlBeUVJSyxDQXpFSixRQTBFSUMsQ0ExRUosQ0EwRWtCdkMsQ0FBSyxDQUFDdUIsUUFBTixDQUFlQyxLQUFmLENBQXFCZ0IsTUExRXZDLEVBNEVFRixDQUFTLENBQUNHLEVBQVYsQ0FBYUYsQ0FBYixDQTVFRix3QkE4RUFwQyxDQUFBQSxNQUFNLENBQUNDLGlCQUFQLENBQXlCLFdBQXpCLENBOUVBLFdBK0VnQ2dCLG9CQUFRc0IsWUFBUixDQUFxQlgsQ0FBckIsQ0FBb0NFLENBQXBDLENBL0VoQyxZQStFTVUsQ0EvRU4sUUFpRklBLENBakZKLGtKQUFGLHdEQURXLEMsVUEwRkY3QyxRIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHV0aWxpdHkgZnJvbSAnLi91dGlsaXR5JztcbmltcG9ydCB0cmFkaW5nIGZyb20gJy4vdHJhZGluZyc7XG5pbXBvcnQgYWNjb3VudCBmcm9tICcuL2FjY291bnQnO1xuXG5jb25zdCB2YWxpZGF0ZSA9IHtcbiAgd2ViMzogYXN5bmMgKHRyYWRlLCBwcm92aWRlciwgc2lnbmVyKSA9PiB7XG5cbiAgICB3aW5kb3cud2ViM1N0YXR1c0hhbmRsZXIoJ2luaXQnKTtcblxuICAgIC8vIGNoZWNrIHRoYXQgd2ViMyBleGlzdHNcbiAgICBpZiAod2luZG93LndlYjMgPT0gdW5kZWZpbmVkIHx8IE9iamVjdC5rZXlzKHdpbmRvdy53ZWIzKS5sZW5ndGggPT0gMCkge1xuICAgICAgd2luZG93LndlYjNTdGF0dXNIYW5kbGVyKCd3ZWIzX3VuZGVmaW5lZCcpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIGFzayB1c2VyIHRvIHVubG9jayBhbmQgY29ubmVjdFxuICAgIGlmICh3aW5kb3cud2ViMyA9PSB1bmRlZmluZWQgfHwgd2luZG93LndlYjMuZXRoLmFjY291bnRzWzBdID09IHVuZGVmaW5lZCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgd2luZG93LmV0aGVyZXVtLmVuYWJsZSgpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyB1c2VyIHJlamVjdGVkIHNjcmVlblxuICAgICAgICB3aW5kb3cud2ViM1N0YXR1c0hhbmRsZXIoJ2Nvbm5lY3RfcmVqZWN0ZWQnKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEF1dG8gdW5sb2NrIGRpZG50IHdvcmssIHdhbGxldCBpcyBzdGlsbCBsb2NrZWRcbiAgICBpZih3aW5kb3cud2ViMy5ldGguYWNjb3VudHNbMF0gPT0gdW5kZWZpbmVkKXtcbiAgICAgIHdpbmRvdy53ZWIzU3RhdHVzSGFuZGxlcigndW5sb2NrX3dhbGxldCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIGNoZWNrIHdlYjMgdHJhZGluZyBpcyBzdXBwb3J0ZWQgZm9yIHRoaXMgZGV4XG4gICAgaWYgKHRyYWRlLmVycm9yID09ICdObyB0cmFkZXMnKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKHdlYjMudmVyc2lvbi5uZXR3b3JrICE9IDEpIHtcbiAgICAgIHdpbmRvdy53ZWIzU3RhdHVzSGFuZGxlcignbmV0d29yaycpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIGNoZWNrIGlmIGV0aGVyIGJhbGFuY2UgaXMgaW5zdWZmaWNpZW50XG4gICAgY29uc3QgZXRoZXJUb1dyYXAgPSBhd2FpdCB1dGlsaXR5LmdldEV0aGVyVG9XcmFwKHRyYWRlLCBwcm92aWRlciwgc2lnbmVyKTtcbiAgICBpZiAoZXRoZXJUb1dyYXAgPT0gLTEpIHtcbiAgICAgIHdpbmRvdy53ZWIzU3RhdHVzSGFuZGxlcignYmFsYW5jZScpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvLyB3cmFwIGV0aGVyIGlmIG5lY2Vzc2FyeVxuICAgIGNvbnN0IHdldGhDb250cmFjdCA9IHV0aWxpdHkuZ2V0V2V0aENvbnRyYWN0KHNpZ25lcik7XG4gICAgY29uc3Qgd3JhcHBpbmcgPSBhd2FpdCB0cmFkaW5nLndyYXAod2V0aENvbnRyYWN0LCBldGhlclRvV3JhcCwgcHJvdmlkZXIpO1xuICAgIGlmICghd3JhcHBpbmcpIHJldHVybiBmYWxzZTtcblxuICAgIC8vIENoZWNrIGlmIGJhbGFuY2UgaXMgaW5zdWZmaWNpZW50XG4gICAgbGV0IGJhbGFuY2U7XG4gICAgaWYodHJhZGUubWV0YWRhdGEuaW5wdXQpe1xuICAgICAgLy8gZXJjMjBcbiAgICAgIGJhbGFuY2UgPSBhd2FpdCBhY2NvdW50LmdldEVSQzIwQmFsYW5jZSh0cmFkZSwgcHJvdmlkZXIsIHNpZ25lcik7XG4gICAgfWVsc2V7XG4gICAgICAvLyBldGhcbiAgICAgIHRyeXtcbiAgICAgICAgYmFsYW5jZSA9IGF3YWl0IGFjY291bnQuZ2V0RVRIQmFsYW5jZSh0cmFkZSk7XG4gICAgICB9Y2F0Y2goZXJyKXtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWJhbGFuY2UpIHtcbiAgICAgIHdpbmRvdy53ZWIzU3RhdHVzSGFuZGxlcignYmFsYW5jZScpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmICh0cmFkZS5tZXRhZGF0YS5pbnB1dCkge1xuICAgICAgLy8gZ2V0IGNvbnRyYWN0c1xuICAgICAgY29uc3QgdG9rZW5Db250cmFjdCA9IHV0aWxpdHkuZ2V0VG9rZW5Db250cmFjdCh0cmFkZSwgc2lnbmVyKTtcbiAgICAgIGNvbnN0IGV4Y2hhbmdlQWRkcmVzcyA9IHRyYWRlLm1ldGFkYXRhLmlucHV0LnNwZW5kZXI7XG4gICAgICAvLyBnZXQgY2xpZW50IGFkZHJlc3NcbiAgICAgIGNvbnN0IGFkZHJlc3MgPSBhd2FpdCBwcm92aWRlci5nZXRTaWduZXIoKS5nZXRBZGRyZXNzKCk7XG4gICAgICAvLyBnZXQgYWxsb3dhbmNlc1xuICAgICAgY29uc3QgYWxsb3dhbmNlID0gYXdhaXQgdG9rZW5Db250cmFjdC5hbGxvd2FuY2UoYWRkcmVzcywgZXhjaGFuZ2VBZGRyZXNzKTtcbiAgICAgIGNvbnN0IHRva2VuQW1vdW50ID0gdHJhZGUubWV0YWRhdGEuaW5wdXQuYW1vdW50O1xuXG4gICAgICBpZiAoYWxsb3dhbmNlLmx0KHRva2VuQW1vdW50KSkge1xuICAgICAgICAvLyBhbGxvd2FuY2UgbmVlZHMgdG8gYmUgZ3JhbnRlZFxuICAgICAgICB3aW5kb3cud2ViM1N0YXR1c0hhbmRsZXIoJ2FsbG93YW5jZScpO1xuICAgICAgICBjb25zdCB0cmFkaW5nX2FsbG93YW5jZSA9IGF3YWl0IHRyYWRpbmcuc2V0QWxsb3dhbmNlKHRva2VuQ29udHJhY3QsIGV4Y2hhbmdlQWRkcmVzcyk7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRva2VuIGFsbG93YW5jZSBpcyBub3Qgc2V0XG4gICAgICAgIGlmKCF0cmFkaW5nX2FsbG93YW5jZSkgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCB2YWxpZGF0ZTtcbiJdfQ==