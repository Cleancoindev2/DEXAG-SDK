"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_utility=_interopRequireDefault(require("./utility")),_trading=_interopRequireDefault(require("./trading")),_account=_interopRequireDefault(require("./account")),validate={web3:function(a){function b(){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(/*#__PURE__*/function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(b,c,d,e){var f,g,h,i,j,k,l,m,n,o;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(e("init"),null!=window.web3&&0!=Object.keys(window.web3).length){a.next=4;break}return e("web3_undefined"),a.abrupt("return",!1);case 4:if(null!=window.web3&&null!=window.web3.eth.accounts[0]){a.next=14;break}return a.prev=5,a.next=8,window.ethereum.enable();case 8:a.next=14;break;case 10:return a.prev=10,a.t0=a["catch"](5),e("connect_rejected"),a.abrupt("return",!1);case 14:if(null!=window.web3.eth.accounts[0]){a.next=17;break}return e("unlock_wallet"),a.abrupt("return");case 17:if("No trades"!=b.error){a.next=19;break}return a.abrupt("return",!1);case 19:if(1==web3.version.network){a.next=22;break}return e("network"),a.abrupt("return",!1);case 22:return a.next=24,_utility["default"].getEtherToWrap(b,c,d);case 24:if(f=a.sent,-1!=f){a.next=28;break}return e("balance"),a.abrupt("return",!1);case 28:return g=_utility["default"].getWethContract(d),a.next=31,_trading["default"].wrap(g,f,c,e);case 31:if(h=a.sent,h){a.next=34;break}return a.abrupt("return",!1);case 34:if("ETH"!=b.metadata.query.from){a.next=40;break}return a.next=37,_account["default"].getETHBalance(b,d);case 37:a.t1=a.sent,a.next=43;break;case 40:return a.next=42,_account["default"].getERC20Balance(b,d);case 42:a.t1=a.sent;case 43:if(i=a.t1,i){a.next=47;break}return e("balance"),a.abrupt("return",!1);case 47:if(!b.metadata.input){a.next=64;break}return j=_utility["default"].getTokenContract(b,d),k=b.metadata.input.spender,a.next=52,c.getSigner().getAddress();case 52:return l=a.sent,a.next=55,j.allowance(l,k);case 55:if(m=a.sent,n=b.metadata.input.amount,!m.lt(n)){a.next=64;break}return e("allowance"),a.next=61,_trading["default"].setAllowance(j,k,c,e);case 61:if(o=a.sent,o){a.next=64;break}return a.abrupt("return",!1);case 64:return a.abrupt("return",!0);case 65:case"end":return a.stop();}},a,null,[[5,10]])}));return function(){return a.apply(this,arguments)}}())},_default=validate;exports["default"]=_default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zZXJ2aWNlcy92YWxpZGF0ZS5qcyJdLCJuYW1lcyI6WyJ2YWxpZGF0ZSIsIndlYjMiLCJ0cmFkZSIsInByb3ZpZGVyIiwic2lnbmVyIiwiaGFuZGxlciIsIndpbmRvdyIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJldGgiLCJhY2NvdW50cyIsImV0aGVyZXVtIiwiZW5hYmxlIiwiZXJyb3IiLCJ2ZXJzaW9uIiwibmV0d29yayIsInV0aWxpdHkiLCJnZXRFdGhlclRvV3JhcCIsImV0aGVyVG9XcmFwIiwid2V0aENvbnRyYWN0IiwiZ2V0V2V0aENvbnRyYWN0IiwidHJhZGluZyIsIndyYXAiLCJ3cmFwcGluZyIsIm1ldGFkYXRhIiwicXVlcnkiLCJmcm9tIiwiYWNjb3VudCIsImdldEVUSEJhbGFuY2UiLCJnZXRFUkMyMEJhbGFuY2UiLCJiYWxhbmNlIiwiaW5wdXQiLCJ0b2tlbkNvbnRyYWN0IiwiZ2V0VG9rZW5Db250cmFjdCIsImV4Y2hhbmdlQWRkcmVzcyIsInNwZW5kZXIiLCJnZXRTaWduZXIiLCJnZXRBZGRyZXNzIiwiYWRkcmVzcyIsImFsbG93YW5jZSIsInRva2VuQW1vdW50IiwiYW1vdW50IiwibHQiLCJzZXRBbGxvd2FuY2UiLCJ0cmFkaW5nX2FsbG93YW5jZSJdLCJtYXBwaW5ncyI6ImdnQkFJTUEsUUFBUSxDQUFHLENBQ2ZDLElBQUksd05BQUUsV0FBT0MsQ0FBUCxDQUFjQyxDQUFkLENBQXdCQyxDQUF4QixDQUFnQ0MsQ0FBaEMsaUhBRUpBLENBQU8sQ0FBQyxNQUFELENBRkgsQ0FLQSxNQUFBQyxNQUFNLENBQUNMLElBQVAsRUFBK0QsQ0FBbkMsRUFBQU0sTUFBTSxDQUFDQyxJQUFQLENBQVlGLE1BQU0sQ0FBQ0wsSUFBbkIsRUFBeUJRLE1BTHJELHVCQU1GSixDQUFBQSxDQUFPLENBQUMsZ0JBQUQsQ0FOTCxpQ0FXQSxNQUFBQyxNQUFNLENBQUNMLElBQVAsRUFBNEIsTUFBQUssTUFBTSxDQUFDTCxJQUFQLENBQVlTLEdBQVosQ0FBZ0JDLFFBQWhCLENBQXlCLENBQXpCLENBWDVCLDJDQWFNTCxNQUFNLENBQUNNLFFBQVAsQ0FBZ0JDLE1BQWhCLEVBYk4sb0VBZ0JBUixDQUFPLENBQUMsa0JBQUQsQ0FoQlAsa0NBc0JELE1BQUFDLE1BQU0sQ0FBQ0wsSUFBUCxDQUFZUyxHQUFaLENBQWdCQyxRQUFoQixDQUF5QixDQUF6QixDQXRCQyx3QkF1QkZOLENBQUFBLENBQU8sQ0FBQyxlQUFELENBdkJMLCtCQTRCZSxXQUFmLEVBQUFILENBQUssQ0FBQ1ksS0E1Qk4sMERBZ0N3QixDQUF4QixFQUFBYixJQUFJLENBQUNjLE9BQUwsQ0FBYUMsT0FoQ2Isd0JBaUNGWCxDQUFBQSxDQUFPLENBQUMsU0FBRCxDQWpDTCxnREFzQ3NCWSxvQkFBUUMsY0FBUixDQUF1QmhCLENBQXZCLENBQThCQyxDQUE5QixDQUF3Q0MsQ0FBeEMsQ0F0Q3RCLFlBc0NFZSxDQXRDRixRQXVDZSxDQUFDLENBQWhCLEVBQUFBLENBdkNBLHdCQXdDRmQsQ0FBQUEsQ0FBTyxDQUFDLFNBQUQsQ0F4Q0wscUNBNENFZSxDQUFBQSxDQTVDRixDQTRDaUJILG9CQUFRSSxlQUFSLENBQXdCakIsQ0FBeEIsQ0E1Q2pCLFdBNkNtQmtCLG9CQUFRQyxJQUFSLENBQWFILENBQWIsQ0FBMkJELENBQTNCLENBQXdDaEIsQ0FBeEMsQ0FBa0RFLENBQWxELENBN0NuQixZQTZDRW1CLENBN0NGLFFBOENDQSxDQTlDRCwwREFpRHdDLEtBQTVCLEVBQUF0QixDQUFLLENBQUN1QixRQUFOLENBQWVDLEtBQWYsQ0FBcUJDLElBakRqQyxtQ0FrRE1DLG9CQUFRQyxhQUFSLENBQXNCM0IsQ0FBdEIsQ0FBNkJFLENBQTdCLENBbEROLDhEQW1ETXdCLG9CQUFRRSxlQUFSLENBQXdCNUIsQ0FBeEIsQ0FBK0JFLENBQS9CLENBbkROLGdDQWlERTJCLENBakRGLE1Bb0RDQSxDQXBERCx3QkFxREYxQixDQUFBQSxDQUFPLENBQUMsU0FBRCxDQXJETCxtQ0F5REFILENBQUssQ0FBQ3VCLFFBQU4sQ0FBZU8sS0F6RGYsd0JBMkRJQyxDQUFBQSxDQTNESixDQTJEb0JoQixvQkFBUWlCLGdCQUFSLENBQXlCaEMsQ0FBekIsQ0FBZ0NFLENBQWhDLENBM0RwQixDQTRESStCLENBNURKLENBNERzQmpDLENBQUssQ0FBQ3VCLFFBQU4sQ0FBZU8sS0FBZixDQUFxQkksT0E1RDNDLFdBOERvQmpDLENBQVEsQ0FBQ2tDLFNBQVQsR0FBcUJDLFVBQXJCLEVBOURwQixlQThESUMsQ0FBQUEsQ0E5REosa0JBZ0VzQk4sQ0FBYSxDQUFDTyxTQUFkLENBQXdCRCxDQUF4QixDQUFpQ0osQ0FBakMsQ0FoRXRCLFlBZ0VJSyxDQWhFSixRQWlFSUMsQ0FqRUosQ0FpRWtCdkMsQ0FBSyxDQUFDdUIsUUFBTixDQUFlTyxLQUFmLENBQXFCVSxNQWpFdkMsRUFtRUVGLENBQVMsQ0FBQ0csRUFBVixDQUFhRixDQUFiLENBbkVGLHdCQXFFQXBDLENBQUFBLENBQU8sQ0FBQyxXQUFELENBckVQLFdBc0VnQ2lCLG9CQUFRc0IsWUFBUixDQUFxQlgsQ0FBckIsQ0FBb0NFLENBQXBDLENBQXFEaEMsQ0FBckQsQ0FBK0RFLENBQS9ELENBdEVoQyxZQXNFTXdDLENBdEVOLFFBd0VJQSxDQXhFSiwwSUFBRix3REFEVyxDLFVBaUZGN0MsUSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB1dGlsaXR5IGZyb20gJy4vdXRpbGl0eSc7XG5pbXBvcnQgdHJhZGluZyBmcm9tICcuL3RyYWRpbmcnO1xuaW1wb3J0IGFjY291bnQgZnJvbSAnLi9hY2NvdW50JztcblxuY29uc3QgdmFsaWRhdGUgPSB7XG4gIHdlYjM6IGFzeW5jICh0cmFkZSwgcHJvdmlkZXIsIHNpZ25lciwgaGFuZGxlcikgPT4ge1xuXG4gICAgaGFuZGxlcignaW5pdCcpO1xuXG4gICAgLy8gY2hlY2sgdGhhdCB3ZWIzIGV4aXN0c1xuICAgIGlmICh3aW5kb3cud2ViMyA9PSB1bmRlZmluZWQgfHwgT2JqZWN0LmtleXMod2luZG93LndlYjMpLmxlbmd0aCA9PSAwKSB7XG4gICAgICBoYW5kbGVyKCd3ZWIzX3VuZGVmaW5lZCcpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIGFzayB1c2VyIHRvIHVubG9jayBhbmQgY29ubmVjdFxuICAgIGlmICh3aW5kb3cud2ViMyA9PSB1bmRlZmluZWQgfHwgd2luZG93LndlYjMuZXRoLmFjY291bnRzWzBdID09IHVuZGVmaW5lZCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgd2luZG93LmV0aGVyZXVtLmVuYWJsZSgpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyB1c2VyIHJlamVjdGVkIHNjcmVlblxuICAgICAgICBoYW5kbGVyKCdjb25uZWN0X3JlamVjdGVkJyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBdXRvIHVubG9jayBkaWRudCB3b3JrLCB3YWxsZXQgaXMgc3RpbGwgbG9ja2VkXG4gICAgaWYod2luZG93LndlYjMuZXRoLmFjY291bnRzWzBdID09IHVuZGVmaW5lZCl7XG4gICAgICBoYW5kbGVyKCd1bmxvY2tfd2FsbGV0Jyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gY2hlY2sgd2ViMyB0cmFkaW5nIGlzIHN1cHBvcnRlZCBmb3IgdGhpcyBkZXhcbiAgICBpZiAodHJhZGUuZXJyb3IgPT0gJ05vIHRyYWRlcycpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAod2ViMy52ZXJzaW9uLm5ldHdvcmsgIT0gMSkge1xuICAgICAgaGFuZGxlcignbmV0d29yaycpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIGNoZWNrIGlmIGV0aGVyIGJhbGFuY2UgaXMgaW5zdWZmaWNpZW50XG4gICAgY29uc3QgZXRoZXJUb1dyYXAgPSBhd2FpdCB1dGlsaXR5LmdldEV0aGVyVG9XcmFwKHRyYWRlLCBwcm92aWRlciwgc2lnbmVyKTtcbiAgICBpZiAoZXRoZXJUb1dyYXAgPT0gLTEpIHtcbiAgICAgIGhhbmRsZXIoJ2JhbGFuY2UnKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy8gd3JhcCBldGhlciBpZiBuZWNlc3NhcnlcbiAgICBjb25zdCB3ZXRoQ29udHJhY3QgPSB1dGlsaXR5LmdldFdldGhDb250cmFjdChzaWduZXIpO1xuICAgIGNvbnN0IHdyYXBwaW5nID0gYXdhaXQgdHJhZGluZy53cmFwKHdldGhDb250cmFjdCwgZXRoZXJUb1dyYXAsIHByb3ZpZGVyLCBoYW5kbGVyKTtcbiAgICBpZiAoIXdyYXBwaW5nKSByZXR1cm4gZmFsc2U7XG5cbiAgICAvLyBDaGVjayBpZiBiYWxhbmNlIGlzIGluc3VmZmljaWVudFxuICAgIGNvbnN0IGJhbGFuY2UgPSB0cmFkZS5tZXRhZGF0YS5xdWVyeS5mcm9tID09J0VUSCdcbiAgICAgID8gYXdhaXQgYWNjb3VudC5nZXRFVEhCYWxhbmNlKHRyYWRlLCBzaWduZXIpXG4gICAgICA6IGF3YWl0IGFjY291bnQuZ2V0RVJDMjBCYWxhbmNlKHRyYWRlLCBzaWduZXIpO1xuICAgIGlmICghYmFsYW5jZSkge1xuICAgICAgaGFuZGxlcignYmFsYW5jZScpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvLyBoYW5kbGUgdG9rZW4gYWxsb3dhbmNlXG4gICAgaWYgKHRyYWRlLm1ldGFkYXRhLmlucHV0KSB7XG4gICAgICAvLyBnZXQgY29udHJhY3RzXG4gICAgICBjb25zdCB0b2tlbkNvbnRyYWN0ID0gdXRpbGl0eS5nZXRUb2tlbkNvbnRyYWN0KHRyYWRlLCBzaWduZXIpO1xuICAgICAgY29uc3QgZXhjaGFuZ2VBZGRyZXNzID0gdHJhZGUubWV0YWRhdGEuaW5wdXQuc3BlbmRlcjtcbiAgICAgIC8vIGdldCBjbGllbnQgYWRkcmVzc1xuICAgICAgY29uc3QgYWRkcmVzcyA9IGF3YWl0IHByb3ZpZGVyLmdldFNpZ25lcigpLmdldEFkZHJlc3MoKTtcbiAgICAgIC8vIGdldCBhbGxvd2FuY2VzXG4gICAgICBjb25zdCBhbGxvd2FuY2UgPSBhd2FpdCB0b2tlbkNvbnRyYWN0LmFsbG93YW5jZShhZGRyZXNzLCBleGNoYW5nZUFkZHJlc3MpO1xuICAgICAgY29uc3QgdG9rZW5BbW91bnQgPSB0cmFkZS5tZXRhZGF0YS5pbnB1dC5hbW91bnQ7XG5cbiAgICAgIGlmIChhbGxvd2FuY2UubHQodG9rZW5BbW91bnQpKSB7XG4gICAgICAgIC8vIGFsbG93YW5jZSBuZWVkcyB0byBiZSBncmFudGVkXG4gICAgICAgIGhhbmRsZXIoJ2FsbG93YW5jZScpO1xuICAgICAgICBjb25zdCB0cmFkaW5nX2FsbG93YW5jZSA9IGF3YWl0IHRyYWRpbmcuc2V0QWxsb3dhbmNlKHRva2VuQ29udHJhY3QsIGV4Y2hhbmdlQWRkcmVzcywgcHJvdmlkZXIsIGhhbmRsZXIpO1xuICAgICAgICAvLyBjaGVjayBpZiB0b2tlbiBhbGxvd2FuY2UgaXMgbm90IHNldFxuICAgICAgICBpZighdHJhZGluZ19hbGxvd2FuY2UpIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgdmFsaWRhdGU7XG4iXX0=